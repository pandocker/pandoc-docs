# まえがき {-}

このドキュメントは、技術書典４にて発表した「私的Markdown-PDF変換環境を紹介する本３」の内容を
Windowsユーザ、特にMSWordと戦う必要がある皆さんに向けて再編集したものです。いままでこのシリーズで
*さんざん忌避されてきた*MSWordあるいはDocxファイルですが、ついに手を出します。嫌だけど。

この本では、Docker及びOffice365が動作するWindows10機[^company-machine]を対象にします。
今更いうほどでもないですがこの本もDockerイメージとCIを使って原稿リポジトリからコンパイルされました。
でも原稿編集はMacで行われました(なんでやねん)。

[^company-machine]: 筆者の会社支給のマシンはOS更新しても相性問題が残るし突然のシャットダウン現象が
治らないしベンダーは遅延戦法で修理回避しようとするしWindows嫌い

Dockerがちゃんと動かないWindows機をお使いの方は、WSLを有効にできるならWSL上に
スクラッチ構築[^refer-previous]すれば等価なものができます。そうでない方は*手元でのコンパイルを諦めて*
外部CIサービスを利用してください。

[^refer-previous]: 前作の「あえて環境を構築してみる編」を参照してください。

Pandoc＋Docxの環境は他の方も研究しているのでN番煎じです。

# 地獄の入口にようこそ

DocxないしMSWord（以下単にWord）と戦うのは本当に骨が折れます。そもそも戦うとか言ってる時点で敵視が
垣間見えますが、Wordが意味不明な挙動をする&&バイナリファイル形式が解析を遅らせるのでのでは仕方が
ありません。

この地獄でもPandocがとても役に立ちます。というかjgm以下Pandocの開発者たちはすごすぎます。

## PandocのDocx対応状況

とりあえずDocxに出力するだけなら以下のコマンドでできます。

```bash
pandoc -t docx -o docx.docx markdown.md
```

出力ファイル`docx.docx`はデフォルトのスタイルを適用したものになります。


# 更新履歴 {-}

## Revision4.0（C95） {-}

![原稿PDFへのリンク](images/QRcode.png){#img:manuscript width=30%}
